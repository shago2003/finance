<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–∏–Ω–∞–Ω—Å—ã</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; background-color: var(--tg-theme-bg-color, #fff); color: var(--tg-theme-text-color, #000); padding: 20px; padding-bottom: 80px; }
        h3 { margin-top: 0; }
        
        /* –°—Ç–∏–ª–∏ –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ */
        label { display: block; margin-top: 15px; font-weight: bold; font-size: 14px; color: var(--tg-theme-hint-color, #888); }
        input, select { width: 100%; padding: 12px; margin-top: 5px; border-radius: 10px; border: 1px solid #ccc; box-sizing: border-box; background-color: var(--tg-theme-secondary-bg-color, #f0f0f0); color: var(--tg-theme-text-color, #000); font-size: 16px; }
        
        /* –ö–Ω–æ–ø–∫–∏ */
        .main-btn { width: 100%; padding: 15px; margin-top: 25px; background-color: var(--tg-theme-button-color, #2481cc); color: var(--tg-theme-button-text-color, #fff); border: none; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; }
        .secondary-btn { width: 100%; padding: 15px; margin-top: 15px; background-color: var(--tg-theme-secondary-bg-color, #f0f0f0); color: var(--tg-theme-text-color, #000); border: none; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; }

        .row { display: flex; gap: 10px; }
        .col { flex: 1; }

        /* –í–∫–ª–∞–¥–∫–∏ (Tabs) */
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.3s; }

        /* –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; background-color: var(--tg-theme-secondary-bg-color, #f0f0f0); display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #ccc; }
        .nav-item { flex: 1; text-align: center; cursor: pointer; opacity: 0.6; font-size: 12px; }
        .nav-item.active { opacity: 1; font-weight: bold; color: var(--tg-theme-button-color, #2481cc); }
        .nav-icon { font-size: 24px; display: block; margin-bottom: 2px; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="tab-expense" class="tab-content active">
        <h3>üí∏ –ù–æ–≤–∞—è —Ç—Ä–∞—Ç–∞</h3>
        <label>–ù–∞ —á—Ç–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª?</label>
        <input type="text" id="item_name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¢–∞–∫—Å–∏">

        <div class="row">
            <div class="col">
                <label>–°—É–º–º–∞</label>
                <input type="number" id="price" placeholder="0" inputmode="decimal" step="0.01">
            </div>
            <div class="col">
                <label>–í–∞–ª—é—Ç–∞</label>
                <select id="currency">
                    <option value="AZN">‚Çº AZN</option>
                    <option value="RUB">‚ÇΩ RUB</option>
                </select>
            </div>
        </div>

        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
        <select id="category_select">
            <option value="–ï–¥–∞">üçî –ï–¥–∞</option>
            <option value="–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç">üöï –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</option>
            <option value="–û—Ñ–∏—Å">üìé –û—Ñ–∏—Å</option>
            <option value="–ó–∞—Ä–ø–ª–∞—Ç–∞">üí∞ –ó–∞—Ä–ø–ª–∞—Ç–∞</option>
            <option value="–ü—Ä–æ—á–µ–µ">üì¶ –ü—Ä–æ—á–µ–µ</option>
        </select>

        <button class="main-btn" onclick="sendExpense()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>

    <div id="tab-category" class="tab-content">
        <h3>üìÇ –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
        <p style="color: #888; font-size: 14px;">–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π.</p>
        
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
        <input type="text" id="new_cat_name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –†–µ–º–æ–Ω—Ç">
        
        <label>–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ (–ø—Ä–∏–º–µ—Ä)</label>
        <input type="text" id="new_cat_word" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–±–æ–∏">

        <button class="main-btn" onclick="sendCategory()">–°–æ–∑–¥–∞—Ç—å</button>
    </div>

    <div id="tab-actions" class="tab-content">
        <h3>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h3>
        
        <button class="secondary-btn" onclick="sendAction('get_stats')">üìä –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
        <button class="secondary-btn" onclick="sendAction('get_file')">üìÇ –°–∫–∞—á–∞—Ç—å Excel —Ñ–∞–π–ª</button>
        <button class="secondary-btn" style="color: red;" onclick="sendAction('delete_menu')">üóë –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏</button>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('expense', this)">
            <span class="nav-icon">üí∏</span>–¢—Ä–∞—Ç—ã
        </div>
        <div class="nav-item" onclick="switchTab('category', this)">
            <span class="nav-icon">‚ûï</span>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏
        </div>
        <div class="nav-item" onclick="switchTab('actions', this)">
            <span class="nav-icon">‚öôÔ∏è</span>–ú–µ–Ω—é
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabId, element) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.getElementById('tab-' + tabId).classList.add('active');
            
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –¢–†–ê–¢–´
        function sendExpense() {
            let item = document.getElementById("item_name").value;
            let price = document.getElementById("price").value;
            let currency = document.getElementById("currency").value;
            let category = document.getElementById("category_select").value;

            if (!item || !price) { tg.showAlert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Å—É–º–º—É!"); return; }

            let data = {
                action: 'add_expense', // –ú–µ—Ç–∫–∞ –¥–ª—è –±–æ—Ç–∞
                title: item,
                price: price,
                curr: currency,
                cat: category
            };
            tg.sendData(JSON.stringify(data));
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ù–û–í–û–ô –ö–ê–¢–ï–ì–û–†–ò–ò
        function sendCategory() {
            let catName = document.getElementById("new_cat_name").value;
            let catWord = document.getElementById("new_cat_word").value;

            if (!catName || !catWord) { tg.showAlert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±–∞ –ø–æ–ª—è!"); return; }

            let data = {
                action: 'add_category', // –ú–µ—Ç–∫–∞ –¥–ª—è –±–æ—Ç–∞
                cat_name: catName,
                word: catWord
            };
            tg.sendData(JSON.stringify(data));
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ö–û–ú–ê–ù–î (–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –§–∞–π–ª)
        function sendAction(actionName) {
            let data = { action: actionName };
            tg.sendData(JSON.stringify(data));
        }
    </script>
</body>
</html>